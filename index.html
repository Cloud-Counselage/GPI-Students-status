<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPI Student Project Status</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f6fa;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #004aad;
            color: white;
            text-align: center;
            padding: 1rem;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        input {
            width: 100%;
            padding: 10px;
            font-size: 1rem;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background-color: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #004aad;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .no-results {
            text-align: center;
            padding: 10px;
            color: red;
        }
    </style>
</head>
<body>

<header>GPI Student Project Status</header>

<div class="container">
    <input type="text" id="searchBox" placeholder="Enter Intern ID to search...">
    <div id="results"></div>
</div>

<script>
    const sheetID = "YOUR_SHEET_ID"; // Replace with Sheet B's ID
    const sheetName = "Sheet1"; // Change if your sheet has a different name
    const baseURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}`;

    let studentData = [];

    // Fetch and parse Google Sheet JSON
    async function fetchData() {
        try {
            const res = await fetch(baseURL);
            const text = await res.text();

            // Remove Google visualization JSON padding
            const json = JSON.parse(text.substr(47).slice(0, -2));

            // Extract rows into JS objects
            studentData = json.table.rows.map(row => row.c.map(cell => cell ? cell.v : ""));

        } catch (err) {
            console.error("Error fetching data:", err);
        }
    }

    // Search by Intern ID
    function searchStudent() {
        const searchValue = document.getElementById("searchBox").value.trim().toLowerCase();
        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = "";

        if (searchValue === "") return;

        const filtered = studentData.filter(row => row[0].toString().toLowerCase() === searchValue);

        if (filtered.length === 0) {
            resultsDiv.innerHTML = `<div class="no-results">No record found</div>`;
            return;
        }

        let tableHTML = "<table><thead><tr>";
        jsonHeaders().forEach(header => tableHTML += `<th>${header}</th>`);
        tableHTML += "</tr></thead><tbody>";

        filtered.forEach(row => {
            tableHTML += "<tr>";
            row.forEach(cell => tableHTML += `<td>${cell}</td>`);
            tableHTML += "</tr>";
        });

        tableHTML += "</tbody></table>";
        resultsDiv.innerHTML = tableHTML;
    }

    // Extract headers from first row of sheet
    function jsonHeaders() {
        // First row in your sheet should contain column names
        return studentData.length > 0 ? studentData[0] : [];
    }

    // Load data and add event listener
    fetchData().then(() => {
        document.getElementById("searchBox").addEventListener("input", searchStudent);
    });
</script>

</body>
</html>
